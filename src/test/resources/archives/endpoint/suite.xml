<?xml version='1.0' encoding='UTF-8'?>
<suite version="174" descriptor="Suite File">
  <xform>
    <resource id="f2816b18a2494b3b88dc010915711195" version="170" descriptor="Form: (Module Case List) - Add Parent">
      <location authority="local">./modules-0/forms-0.xml</location>
      <location authority="remote">./modules-0/forms-0.xml</location>
    </resource>
  </xform>
  <xform>
    <resource id="68247e4bb99d4ef182e10a62c440a898" version="170" descriptor="Form: (Module Case List) - Followup">
      <location authority="local">./modules-0/forms-1.xml</location>
      <location authority="remote">./modules-0/forms-1.xml</location>
    </resource>
  </xform>
  <xform>
    <resource id="10e8ddfc40c84c1c8412d29c74ba20f2" version="148" descriptor="Form: (Module Parents) - Add Child">
      <location authority="local">./modules-1/forms-0.xml</location>
      <location authority="remote">./modules-1/forms-0.xml</location>
    </resource>
  </xform>
  <xform>
    <resource id="d46bdd329c8a431aae4033d2b273f05a" version="148" descriptor="Form: (Module Child Case List) - Update Child">
      <location authority="local">./modules-2/forms-0.xml</location>
      <location authority="remote">./modules-2/forms-0.xml</location>
    </resource>
  </xform>
  <locale language="default">
    <resource id="app_default_strings" version="174" descriptor="Translations: Default Language">
      <location authority="local">./default/app_strings.txt</location>
      <location authority="remote">./default/app_strings.txt</location>
    </resource>
  </locale>
  <locale language="en">
    <resource id="app_en_strings" version="174" descriptor="Translations: English">
      <location authority="local">./en/app_strings.txt</location>
      <location authority="remote">./en/app_strings.txt</location>
    </resource>
  </locale>
  <detail id="m0_case_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m0.case_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="false">
      <display>
        <text>
          <locale id="case_search.m0"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m0'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m0_case_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m0.case_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m0_search_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m0.search_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="true">
      <display>
        <text>
          <locale id="case_search.m0.again"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m0'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m0_search_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m0.search_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m1_case_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m1.case_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="false">
      <display>
        <text>
          <locale id="case_search.m1"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m1'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m1_case_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m1.case_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m1_search_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m1.search_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="true">
      <display>
        <text>
          <locale id="case_search.m1.again"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m1'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m1_search_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m1.search_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m2_case_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m2.case_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="false">
      <display>
        <text>
          <locale id="case_search.m2"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m2'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m2_case_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m2.case_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m2_search_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m2.search_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
    <action auto_launch="false()" redo_last="true">
      <display>
        <text>
          <locale id="case_search.m2.again"/>
        </text>
      </display>
      <stack>
        <push>
          <mark/>
          <command value="'search_command.m2'"/>
        </push>
      </stack>
    </action>
  </detail>
  <detail id="m2_search_long">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m2.search_long.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
    </field>
  </detail>
  <detail id="m5_case_short">
    <title>
      <text>
        <locale id="cchq.case"/>
      </text>
    </title>
    <field>
      <header>
        <text>
          <locale id="m5.case_short.case_name_1.header"/>
        </text>
      </header>
      <template>
        <text>
          <xpath function="case_name"/>
        </text>
      </template>
      <sort type="string" order="1" direction="ascending">
        <text>
          <xpath function="case_name"/>
        </text>
      </sort>
    </field>
  </detail>
  <entry>
    <form>http://openrosa.org/formdesigner/64B9C6C2-5CBA-47FF-A2CE-FC79556B69A2</form>
    <command id="m0-f0">
      <text>
        <locale id="forms.m0f0"/>
      </text>
    </command>
    <session>
      <datum id="case_id_new_case_0" function="uuid()"/>
    </session>
  </entry>
  <entry>
    <form>http://openrosa.org/formdesigner/45B35482-A374-4FCA-B2E3-022C571B1151</form>
    <command id="m0-f1">
      <text>
        <locale id="forms.m0f1"/>
      </text>
    </command>
    <instance id="casedb" src="jr://instance/casedb"/>
    <session>
      <datum id="case_id" nodeset="instance('casedb')/casedb/case[@case_type='case'][@status='open']" value="./@case_id" detail-select="m0_case_short" detail-confirm="m0_case_long"/>
    </session>
  </entry>
  <entry>
    <form>http://openrosa.org/formdesigner/76643AC2-F7E8-401B-A8DD-418920D5A9BC</form>
    <command id="m1-f0">
      <text>
        <locale id="forms.m1f0"/>
      </text>
    </command>
    <instance id="casedb" src="jr://instance/casedb"/>
    <instance id="commcaresession" src="jr://instance/session"/>
    <session>
      <datum id="case_id" nodeset="instance('casedb')/casedb/case[@case_type='case'][@status='open']" value="./@case_id" detail-select="m1_case_short" detail-confirm="m1_case_long"/>
      <datum id="case_id_new_child_case_0" function="uuid()"/>
    </session>
    <stack>
      <create>
        <command value="'m1'"/>
        <datum id="case_id" value="instance('commcaresession')/session/data/case_id"/>
        <datum id="case_id_new_child_case_0" value="uuid()"/>
      </create>
    </stack>
  </entry>
  <entry>
    <form>http://openrosa.org/formdesigner/ADC2C242-4A17-400B-9491-F5DE8FF40DBD</form>
    <command id="m2-f0">
      <text>
        <locale id="forms.m2f0"/>
      </text>
    </command>
    <instance id="casedb" src="jr://instance/casedb"/>
    <instance id="commcaresession" src="jr://instance/session"/>
    <session>
      <datum id="case_id" nodeset="instance('casedb')/casedb/case[@case_type='case'][@status='open']" value="./@case_id" detail-select="m0_case_short"/>
      <datum id="case_id_new_child_case_0" function="uuid()"/>
      <datum id="case_id_child_case" nodeset="instance('casedb')/casedb/case[@case_type='child_case'][@status='open'][index/parent=instance('commcaresession')/session/data/case_id]" value="./@case_id" detail-select="m2_case_short" detail-confirm="m2_case_long"/>
    </session>
    <stack>
      <create>
        <command value="'m1'"/>
        <command value="'m2'"/>
        <datum id="case_id" value="instance('commcaresession')/session/data/case_id"/>
        <datum id="case_id_new_child_case_0" value="uuid()"/>
        <command value="'m2-f0'"/>
      </create>
    </stack>
  </entry>
  <entry>
    <form>http://openrosa.org/formdesigner/ADC2C242-4A17-400B-9491-F5DE8FF40DBD</form>
    <post url="http://localhost:8000/a/test-1/phone/claim-case/">
      <data key="case_id" ref="instance('commcaresession')/session/data/case_id"/>
    </post>
    <command id="m5-f0">
      <text>
        <locale id="forms.m5f0"/>
      </text>
    </command>
    <instance id="commcaresession" src="jr://instance/session"/>
    <instance id="results:inline" src="jr://instance/remote/results:inline"/>
    <session>
      <query url="http://localhost:8000/a/test-1/phone/search/343af03494944cf4affdf775964eba54/" storage-instance="results:inline" template="case" default_search="true" dynamic_search="false">
        <data key="case_type" ref="'case'"/>
        <prompt key="name">
          <display>
            <text>
              <locale id="search_property.m5.name"/>
            </text>
          </display>
        </prompt>
      </query>
      <datum id="case_id" nodeset="instance('results:inline')/results/case[@case_type='case'][@status='open'][not(commcare_is_related_case=true())]" value="./@case_id" detail-select="m5_case_short"/>
    </session>
  </entry>
  <entry>
    <form>http://openrosa.org/formdesigner/ADC2C242-4A17-400B-9491-F5DE8FF40DBD</form>
    <post url="http://localhost:8000/a/test-1/phone/claim-case/">
      <data key="case_id" ref="instance('commcaresession')/session/data/case_id"/>
    </post>
    <command id="m5-f1">
      <text>
        <locale id="forms.m5f1"/>
      </text>
    </command>
    <instance id="commcaresession" src="jr://instance/session"/>
    <instance id="results:inline" src="jr://instance/remote/results:inline"/>
    <session>
      <query url="http://localhost:8000/a/test-1/phone/search/343af03494944cf4affdf775964eba54/" storage-instance="results:inline" template="case" default_search="true" dynamic_search="false">
        <data key="case_type" ref="'case'"/>
        <prompt key="name">
          <display>
            <text>
              <locale id="search_property.m5.name"/>
            </text>
          </display>
        </prompt>
      </query>
      <datum id="case_id" nodeset="instance('results:inline')/results/case[@case_type='case'][@status='open'][not(commcare_is_related_case=true())]" value="./@case_id" detail-select="m5_case_short"/>
    </session>
  </entry>
  <menu id="m0">
    <text>
      <locale id="modules.m0"/>
    </text>
    <command id="m0-f0"/>
    <command id="m0-f1"/>
  </menu>
  <menu id="m1">
    <text>
      <locale id="modules.m1"/>
    </text>
    <command id="m1-f0"/>
  </menu>
  <menu root="m1" id="m2">
    <text>
      <locale id="modules.m2"/>
    </text>
    <command id="m2-f0"/>
  </menu>
  <menu id="m3" relevant="1=2">
    <text>
      <locale id="modules.m1"/>
    </text>
    <command id="m1-f0" relevant="1=2"/>
  </menu>
  <menu id="m4" relevant="1=2">
    <text>
      <locale id="modules.m1"/>
    </text>
    <command id="m0-f1" relevant="1=2"/>
    <command id="m1-f0"/>
  </menu>
  <menu id="m5">
    <text>
      <locale id="modules.m5"/>
    </text>
    <command id="m5-f0"/>
    <command id="m5-f1"/>
  </menu>
  <remote-request>
    <post url="http://localhost:8000/a/test-1/phone/claim-case/" relevant="count(instance('casedb')/casedb/case[@case_id=instance('commcaresession')/session/data/search_case_id]) = 0">
      <data key="case_id" ref="instance('commcaresession')/session/data/search_case_id"/>
    </post>
    <command id="search_command.m0">
      <display>
        <text>
          <locale id="case_search.m0"/>
        </text>
      </display>
    </command>
    <instance id="case_search_choices" src="jr://fixture/item-list:case_search_choices"/>
    <instance id="casedb" src="jr://instance/casedb"/>
    <instance id="commcaresession" src="jr://instance/session"/>
    <instance id="district" src="jr://fixture/item-list:district"/>
    <instance id="state" src="jr://fixture/item-list:state"/>
    <session>
      <query url="http://localhost:8000/a/test-1/phone/search/343af03494944cf4affdf775964eba54/" storage-instance="results" template="case" default_search="false">
        <data key="case_type" ref="'case'"/>
        <prompt key="name" default="&quot;d&quot;">
          <display>
            <text>
              <locale id="search_property.m0.name"/>
            </text>
          </display>
        </prompt>
      </query>
      <datum id="search_case_id" nodeset="instance('results')/results/case[@case_type='case']" value="./@case_id" detail-select="m0_search_short" detail-confirm="m0_search_long"/>
    </session>
    <stack>
      <push>
        <rewind value="instance('commcaresession')/session/data/search_case_id"/>
      </push>
    </stack>
  </remote-request>
  <remote-request>
    <post url="http://localhost:8000/a/test-1/phone/claim-case/" relevant="count(instance('casedb')/casedb/case[@case_id=instance('commcaresession')/session/data/search_case_id]) = 0">
      <data key="case_id" ref="instance('commcaresession')/session/data/search_case_id"/>
    </post>
    <command id="search_command.m1">
      <display>
        <text>
          <locale id="case_search.m1"/>
        </text>
      </display>
    </command>
    <instance id="casedb" src="jr://instance/casedb"/>
    <instance id="commcaresession" src="jr://instance/session"/>
    <session>
      <query url="http://localhost:8000/a/test-1/phone/search/343af03494944cf4affdf775964eba54/" storage-instance="results" template="case" default_search="false">
        <data key="case_type" ref="'case'"/>
        <prompt key="name" default="&quot;d&quot;">
          <display>
            <text>
              <locale id="search_property.m1.name"/>
            </text>
          </display>
        </prompt>
      </query>
      <datum id="search_case_id" nodeset="instance('results')/results/case[@case_type='case']" value="./@case_id" detail-select="m1_search_short" detail-confirm="m1_search_long"/>
    </session>
    <stack>
      <push>
        <rewind value="instance('commcaresession')/session/data/search_case_id"/>
      </push>
    </stack>
  </remote-request>
  <remote-request>
    <post url="http://localhost:8000/a/test-1/phone/claim-case/" relevant="count(instance('casedb')/casedb/case[@case_id=instance('commcaresession')/session/data/search_case_id]) = 0">
      <data key="case_id" ref="instance('commcaresession')/session/data/search_case_id"/>
    </post>
    <command id="search_command.m2">
      <display>
        <text>
          <locale id="case_search.m2"/>
        </text>
      </display>
    </command>
    <instance id="casedb" src="jr://instance/casedb"/>
    <instance id="commcaresession" src="jr://instance/session"/>
    <session>
      <query url="http://localhost:8000/a/test-1/phone/search/343af03494944cf4affdf775964eba54/" storage-instance="results" template="case" default_search="false">
        <data key="case_type" ref="'child_case'"/>
        <prompt key="name">
          <display>
            <text>
              <locale id="search_property.m2.name"/>
            </text>
          </display>
        </prompt>
      </query>
      <datum id="search_case_id" nodeset="instance('results')/results/case[@case_type='child_case']" value="./@case_id" detail-select="m2_search_short" detail-confirm="m2_search_long"/>
    </session>
    <stack>
      <push>
        <rewind value="instance('commcaresession')/session/data/search_case_id"/>
      </push>
    </stack>
  </remote-request>
  <endpoint id="caselist">
    <stack>
      <push>
        <command value="'m0'"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="add_parent">
    <stack>
      <push>
        <command value="'m0'"/>
        <command value="'m0-f0'"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="followup">
    <argument id="case_id"/>
    <stack>
      <push>
        <command value="'m0'"/>
        <command value="'m0-f1'"/>
        <datum id="case_id" value="$case_id"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="parents">
    <argument id="case_id"/>
    <stack>
      <push>
        <command value="'m1'"/>
        <datum id="case_id" value="$case_id"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="add_child">
    <argument id="case_id"/>
    <stack>
      <push>
        <command value="'m1'"/>
        <datum id="case_id" value="$case_id"/>
        <command value="'m1-f0'"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="child_case_list">
    <argument id="case_id"/>
    <argument id="case_id_child_case"/>
    <stack>
      <push>
        <command value="'m1'"/>
        <datum id="case_id" value="$case_id"/>
        <command value="'m2'"/>
        <datum id="case_id_child_case" value="$case_id_child_case"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="update_child">
    <argument id="case_id"/>
    <argument id="case_id_child_case"/>
    <stack>
      <push>
        <command value="'m1'"/>
        <datum id="case_id" value="$case_id"/>      
        <command value="'m2'"/>
        <datum id="case_id_child_case" value="$case_id_child_case"/>
        <command value="'m2-f0'"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="add_child_respect_relevancy">
    <argument id="case_id"/>
    <stack>
      <push>
        <command value="'m3'"/>
        <datum id="case_id" value="$case_id"/>
        <command value="'m1-f0'"/>
      </push>
    </stack>
  </endpoint>
  <endpoint id="add_child_not_respect_relevancy" respect-relevancy="false">
    <argument id="case_id" />
    <stack>
      <push>
        <command value="'m3'" />
        <datum id="case_id" value="$case_id" />
        <command value="'m1-f0'" />
      </push>
    </stack>
  </endpoint>
  <endpoint id="add_child_not_respect_relevancy_m0_f1" respect-relevancy="false">
    <argument id="case_id" />
    <stack>
      <push>
        <command value="'m4'" />
        <datum id="case_id" value="$case_id" />
        <command value="'m0-f1'" />
      </push>
    </stack>
  </endpoint>
  <endpoint id="inline_w_display_cond_case_list">
    <argument id="case_id"/>
    <stack>
      <push>
        <command value="'m5'"/>
        <query id="results:inline" value="http://localhost:8000/a/test-1/phone/case_fixture/343af03494944cf4affdf775964eba54/">
          <data key="case_type" ref="'case'"/>
          <data key="case_id" ref="$case_id"/>
        </query>
        <datum id="case_id" value="$case_id"/>
      </push>
    </stack>
  </endpoint>
</suite>
